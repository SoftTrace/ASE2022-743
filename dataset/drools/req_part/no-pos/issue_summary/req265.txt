refactor core reteoo code sinl composit propag 
